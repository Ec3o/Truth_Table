<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çœŸå€¼è¡¨ç”Ÿæˆå™¨</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5dc; /* ç±³è‰²èƒŒæ™¯ */
        }

        h2 {
            color: #333;
            text-align: center;
        }

        label {
            font-weight: bold;
            margin-bottom: 5px;
            display: block;
        }

        input[type="text"] {
            padding: 8px;
            font-size: 16px;
            width: 100%; /* å æ®æ•´ä¸ªå®½åº¦ */
            border: 1px solid #ccc;
            border-radius: 5px;
            margin-bottom: 15px;
            transition: border-color 0.3s ease-in-out;
        }

        input[type="text"]:focus {
            border-color: #555;
        }

        .table-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: flex-start; /* å·¦å¯¹é½ */
        }

        .table-container table {
            margin-right: 20px;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }

        .table-container table.loaded {
            opacity: 1;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }

        th {
            background-color: #f2f2f2;
        }

        tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        tr:hover {
            background-color: #ddd;
        }

    </style>
</head>
<body>
<h2>ç®€æ˜“çœŸå€¼è¡¨ç”Ÿæˆå™¨</h2>
<br><strong>çœŸå€¼è¡¨ç”Ÿæˆå™¨ğŸ¥³</strong><br><br>è€ƒè™‘åˆ°è¾“å…¥é—®é¢˜ï¼Œè¯·ä½¿ç”¨<strong>!</strong>ä½œä¸º<strong>Â¬</strong>ï¼Œ<strong>&</strong>ä½œä¸º<strong>â‹€</strong>ï¼Œ<strong>|</strong>ä½œä¸º<strong>â‹</strong>ï¼Œ<strong>â†’</strong>å’Œ<strong>â‡”</strong>å¯æ­£å¸¸å¤„ç†ã€‚</p>
<p>ç¤ºä¾‹è¾“å…¥ï¼š!a&(b|a)â‡”câ†’b</p>
<label for="expression">è¾“å…¥ä½ çš„é€»è¾‘è¡¨è¾¾å¼ğŸ¥°</label><br>
<input type="text" id="expression" name="expression"><br>
<div class="table-container">
    <table id="truthTableLeft" class="left">
        <thead id="headerRowLeft">
        <!-- Header row will be dynamically populated -->
        </thead>
        <tbody id="tableBodyLeft">
        <!-- Table body will be dynamically populated -->
        </tbody>
    </table>
    <table id="truthTableRight">
        <thead id="headerRowRight">
        <!-- Header row will be dynamically populated -->
        </thead>
        <tbody id="tableBodyRight">
        <!-- Table body will be dynamically populated -->
        </tbody>
    </table>
</div>

<script>
    function displayTruthTable(data, tableId) {
        var truthTable = JSON.parse(data); // Parse JSON string to JavaScript object
        var table = document.getElementById(tableId);

        // Clear table
        table.innerHTML = "";

        // Create header row
        var headerRow = document.createElement("tr");
        var headerKeys = Object.keys(truthTable[0]);
        headerKeys.forEach(function (key) {
            var th = document.createElement("th");
            th.textContent = replaceLogicSymbols(key);
            headerRow.appendChild(th);
        });
        table.appendChild(headerRow);

        // Create table body
        var tableBody = document.createElement("tbody");
        truthTable.forEach(function (row) {
            var tr = document.createElement("tr");
            headerKeys.forEach(function (key) {
                var td = document.createElement("td");
                td.textContent = row[key];
                tr.appendChild(td);
            });
            tableBody.appendChild(tr);
        });
        table.appendChild(tableBody);

        // Add loaded class to table to trigger the fade-in effect
        table.classList.add('loaded');
    }

    // Function to fetch truth table data
    function fetchTruthTableData() {
        const exprInput = encodeURIComponent(document.getElementById('expression').value);
        if (!exprInput) {
            clearTables();
            return;
        }
        fetch('/api/data?exp=' + exprInput) // Use user input expression
            .then(function (response) {
                if (!response.ok) {
                    throw new Error("There was a problem with the fetch operation: " + response.statusText);
                }
                return response.json(); // Use response.json() to parse JSON data
            })
            .then(function (data) {
                var tableId = data.length > 10 ? "truthTableRight" : "truthTableLeft"; // Choose table based on expression length
                displayTruthTable(data, tableId);
            })
            .catch(function (error) {
                console.error(error);
            });
    }

    // Function to clear tables
    function clearTables() {
        document.getElementById("truthTableLeft").innerHTML = "";
        document.getElementById("truthTableRight").innerHTML = "";
    }
    function replaceLogicSymbols(expression) {
        return expression.replace(/!/g, 'Â¬')
            .replace(/&/g, 'â‹€')
            .replace(/\|/g, 'â‹');
    }
    // Event listener for input change
    document.getElementById('expression').addEventListener('input', fetchTruthTableData);

    // Initial fetch truth table data
    fetchTruthTableData();
</script>
</body>
</html>
